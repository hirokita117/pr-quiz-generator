# Mastra AI リバースエンジニアリング用プロンプト集

このドキュメントは、PR Quiz GeneratorアプリケーションをMastra AI（https://github.com/mastra-ai/mastra）で再実装するためのリバースエンジニアリング用プロンプト集です。

## 目次
1. [基本的なアーキテクチャ分析](#1-基本的なアーキテクチャ分析)
2. [Mastra実装への変換](#2-mastra実装への変換)
3. [Mastra特有機能の活用](#3-mastra特有機能の活用)
4. [完全な移行設計書](#4-完全な移行設計書)
5. [段階的実装プロンプト](#5-段階的実装プロンプト)
6. [使用例とベストプラクティス](#6-使用例とベストプラクティス)

---

## 1. 基本的なアーキテクチャ分析

### プロンプト1: Mastraフレームワーク分析込みのアーキテクチャ分析
```
「このPR Quiz GeneratorアプリケーションをMastra（https://github.com/mastra-ai/mastra）で再実装するために、現在のアーキテクチャを分析してください。特に：
- 現在のReact/Zustandベースの実装をMastraのワークフロー/エージェントパターンにどうマッピングするか
- MastraのIntegration機能を使ったGitHub API統合の設計
- MastraのLLM抽象化レイヤーでの複数AIプロバイダー対応方法」
```

### プロンプト2: データフローとコンポーネント分析
```
「このPR Quiz Generatorアプリケーションの全体的なアーキテクチャと主要コンポーネントを分析してください。特に以下の点を重点的に：
- データフローとコンポーネント間の相互作用
- 状態管理のパターン
- AIサービスの抽象化レイヤー
- GitHub APIとの統合方法」
```

### プロンプト3: ビジネスロジック抽出
```
「クイズ生成の核となるビジネスロジックを詳細に分析してください：
- PRデータからクイズを生成するプロセス
- AIプロンプトの構造と生成ロジック
- 難易度やフォーカスエリアの処理方法
- エラーハンドリングとリトライロジック」
```

---

## 2. Mastra実装への変換

### プロンプト4: コンポーネント変換マッピング
```
「以下の現在の実装をMastraフレームワークのコンポーネントに変換してください：
- src/services/ai.ts → MastraのLLM/Agent設定
- src/services/github.ts → MastraのIntegration/Tool定義
- src/store/useQuizStore.ts → MastraのWorkflow状態管理
- クイズ生成ロジック → MastraのWorkflow定義（.workflow()）
具体的なMastraのコード例も示してください」
```

### プロンプト5: 技術的実装詳細の抽出
```
「以下の技術的実装の詳細を抽出してください：
- TypeScriptの型定義構造
- AIサービスのファクトリーパターン実装
- GitHub APIのレート制限処理
- セキュリティ（機密データのサニタイズ）実装」
```

---

## 3. Mastra特有機能の活用

### プロンプト6: Mastra機能活用提案
```
「Mastraフレームワーク（https://github.com/mastra-ai/mastra）の以下の機能を活用して、このPRクイズジェネレーターを再実装する方法を提案してください：
- Mastra Agents: クイズ生成エージェントの設計
- Mastra Tools: GitHub API、クイズ検証ツールの実装
- Mastra Workflows: PR分析→クイズ生成→検証のパイプライン
- Mastra Memory: クイズ履歴やユーザー設定の永続化
- Mastra Integrations: GitHub、OpenAI、Gemini統合の実装」
```

---

## 4. 完全な移行設計書

### プロンプト7: 包括的な移行設計書
```
「PR Quiz GeneratorをMastra（https://github.com/mastra-ai/mastra）で完全に再実装するための技術設計書を作成してください。以下を含む：

1. Mastraプロジェクト構造:
   - mastra.config.ts の設定内容
   - エージェント定義ファイル
   - ワークフロー定義
   - ツール/統合定義

2. 実装マッピング表:
   現在のコンポーネント → Mastraコンポーネント

3. サンプルコード:
   - GitHub PR取得のMastra Tool実装
   - クイズ生成のMastra Workflow実装
   - 複数LLMプロバイダーのMastra設定

4. デプロイメント:
   - Mastraの推奨デプロイ方法
   - 環境変数の移行」
```

---

## 5. 段階的実装プロンプト

### プロンプト8: フェーズごとの実装計画
```
「MastraフレームワークでPR Quiz Generatorを段階的に実装する計画を作成してください：

Phase 1: 基本セットアップ
- Mastraプロジェクトの初期化
- GitHub統合の設定
- 単一LLMプロバイダー（OpenAI）での動作確認

Phase 2: コア機能
- PR分析ワークフローの実装
- クイズ生成エージェントの作成
- 基本的なクイズ生成の動作

Phase 3: 高度な機能
- 複数LLMプロバイダー対応
- メモリ/キャッシュ機能
- エラーハンドリングとリトライ

各フェーズでのMastraコード例を含めてください」
```

---

## 6. 使用例とベストプラクティス

### 統合プロンプト例
```
「このリポジトリをリバースエンジニアリングして、Mastra（https://github.com/mastra-ai/mastra）で同等の機能を実装したい。まず現在のアーキテクチャを分析し、それをMastraのAgent、Workflow、Tool、Integrationパターンにマッピングする方法を示してください。特にMastraのLLM抽象化機能を使った複数AIプロバイダー対応と、GitHub統合の実装方法に重点を置いて分析してください。」
```

### 視覚化を含むプロンプト
```
「Mermaidダイアグラムを使って、現在のアーキテクチャとMastraベースの新しいアーキテクチャを比較してください。データフロー、コンポーネント間の依存関係、AIサービスの統合方法を明確に示してください。」
```

### 比較分析プロンプト
```
「現在のReact/Zustand実装とMastra AIでの実装の違いを表形式で示してください。各コンポーネント、状態管理、API統合、エラーハンドリングの観点から比較してください。」
```

### MVP実装プロンプト
```
「MVPとして最初に実装すべきコア機能を特定してください。Mastraを使った最小限の実装で、GitHub PRからクイズを生成する基本機能を動作させるために必要なコンポーネントとその実装順序を示してください。」
```

---

## 効果的な使い方

### 1. 段階的アプローチ
- まず全体像を把握するためにプロンプト1-3を使用
- 次に具体的な実装詳細のためにプロンプト4-5を使用
- 最後に実装計画のためにプロンプト7-8を使用

### 2. カスタマイズ
各プロンプトは必要に応じてカスタマイズ可能です。特定の機能や要件に焦点を当てたい場合は、プロンプトを調整してください。

### 3. 追加コンテキストの提供
より正確な分析のために、以下の情報を追加で提供することを推奨します：
- 特定の機能要件
- パフォーマンス要件
- スケーラビリティ要件
- 既存のインフラストラクチャ制約

### 4. 反復的な改善
最初のプロンプトの結果を基に、より詳細な質問や特定の領域に焦点を当てた追加プロンプトを作成してください。

---

## 注意事項

- これらのプロンプトは、PR Quiz GeneratorをMastraフレームワークで再実装するための出発点です
- 実際の実装では、Mastraの最新ドキュメントとAPIリファレンスを参照してください
- プロジェクト固有の要件に応じて、プロンプトを調整する必要があります

---

## 更新履歴

- 初版作成: このドキュメントの初版を作成しました